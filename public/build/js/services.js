document.addEventListener("DOMContentLoaded",()=>{initServices()});const initServices=()=>{initModal()},initModal=()=>{document.querySelector("#createService").addEventListener("click",()=>{openModal()});document.querySelectorAll("[name='serviceUpdate']").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.id,c=e.target.dataset.servicename,a=e.target.dataset.serviceprice;openModal(t,c,a)})});const e=document.querySelector("dialog");document.querySelector("#cancel-modal").addEventListener("click",()=>{e.close()}),e.addEventListener("click",t=>{const c=e.getBoundingClientRect();(t.clientX<c.left||t.clientX>c.right||t.clientY<c.top||t.clientY>c.bottom)&&e.close()}),submitBtn=document.querySelector("#submit-modal"),submitBtn.addEventListener("click",()=>{const e=document.querySelector("#dialogServiceId").value,t=document.querySelector("#dialogServiceName").value,c=document.querySelector("#dialogServicePrice").value;saveService(e,t,c)})},openModal=(e=0,t="",c="")=>{const a=document.querySelector("#dialogServiceId"),r=document.querySelector("#dialogServiceName"),i=document.querySelector("#dialogServicePrice");a.value=e,r.value=t,i.value=c,document.querySelector("dialog").showModal()},saveService=async(e,t,c)=>{const a=new FormData;a.append("id",e),a.append("serviceName",t),a.append("price",c);try{const t=await fetch("/api/saveService",{method:"POST",body:a}),c=await t.json(),r="0"!==e?c.result:c.result.resultado;document.querySelector("dialog").close(),r?Swal.fire({icon:"success",title:"Servicio creado",text:"¡Cita creado correctamente!"}).then(()=>{console.log("llego"),renderService(c.service)}):Swal.fire({icon:"error",title:"Error",text:"Ocurrió un error guardando la cita"})}catch(e){Swal.fire({icon:"error",title:"Error",text:"Ocurrió un error guardando la cita - "+e})}},renderService=e=>{const{id:t,serviceName:c,price:a}=e;let r=Array.from(document.querySelectorAll("ul[id='service-list'] li")).find(e=>e.dataset.serviceId===t);if(r)r.innerHTML=`\n            <p><span>Nombre:</span> <span class="service-desc">${c}</span></p>\n            <p><span>Precio:</span> $ <span class="service-desc">${a}</span></p>\n            <div class="buttons-container">\n                <input type="button" class="button" value="Actualizar servicio" name="serviceUpdate" data-id="${t}" data-serviceName="${c}" data-servicePrice="${a}">\n                \n                <input type="button" class="button-delete" value="Eliminar servicio" name="serviceDelete" data-id="${t}">\n            </div>\n        `;else{const e=`\n            <li data-service-id="${t}">\n                <p><span>Nombre:</span> <span class="service-desc">${c}</span></p>\n                <p><span>Precio:</span> $ <span class="service-desc">${a}</span></p>\n                <div class="buttons-container">\n                    <input type="button" class="button" value="Actualizar servicio" name="serviceUpdate" data-id="${t}" data-serviceName="${c}" data-servicePrice="${a}">\n                    \n                    <input type="button" class="button-delete" value="Eliminar servicio" name="serviceDelete" data-id="${t}">\n                </div>\n            </li>\n            <hr>\n        `;document.querySelector("#service-list").insertAdjacentHTML("beforeend",e)}};