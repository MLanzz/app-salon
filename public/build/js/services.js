document.addEventListener("DOMContentLoaded",()=>{initServices()});const initServices=()=>{initModal()},initModal=()=>{document.querySelector("#createService").addEventListener("click",()=>{openModal()});document.querySelectorAll("[name='serviceUpdate']").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.id,c=e.target.dataset.serviceName,r=e.target.dataset.servicePrice;openModal(t,c,r)})});const e=document.querySelector("dialog");document.querySelector("#cancel-modal").addEventListener("click",()=>{e.close()}),e.addEventListener("click",t=>{const c=e.getBoundingClientRect();(t.clientX<c.left||t.clientX>c.right||t.clientY<c.top||t.clientY>c.bottom)&&e.close()}),submitBtn=document.querySelector("#submit-modal"),submitBtn.addEventListener("click",()=>{const e=document.querySelector("#dialogServiceId"),t=document.querySelector("#dialogServiceName"),c=document.querySelector("#dialogServicePrice");saveService(e,t,c)})},openModal=(e=0,t="",c="")=>{const r=document.querySelector("#dialogServiceId"),o=document.querySelector("#dialogServiceName"),i=document.querySelector("#dialogServicePrice");r.value=e,o.value=t,i.value=c,document.querySelector("dialog").showModal()},saveService=async(e,t,c)=>{const r=new FormData;r.append("serviceId",e),r.append("serviceName",t),r.append("servicePrice",c);try{const e=(await fetch("/api/saveService",{method:"POST",body:r})).json();e.result&&Swal.fire({icon:"success",title:"Cita creada",text:"¡Cita agendada correctamente!"}).then(()=>{renderService(e.service)})}catch(e){Swal.fire({icon:"error",title:"Error",text:"Ocurrió un error guardando la cita - "+e})}},renderService=e=>{document.querySelector("#serviceList");let t=Array.from(document.querySelectorAll("ul[id='service-list'] li")).find(t=>t.dataset.serviceId===e.id);t?console.log("Se esta actualizando"):console.log("Se esta creando"),console.log(t)};